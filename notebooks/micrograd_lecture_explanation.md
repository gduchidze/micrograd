# ­ЪјЊ Micrograd рЃџрЃћрЃЦрЃфрЃўрЃљ - рЃАрЃарЃБрЃџрЃў рЃљрЃ«рЃАрЃюрЃљ рЃАрЃЎрЃЮрЃџрЃўрЃА рЃЏрЃЮрЃАрЃгрЃљрЃЋрЃџрЃћрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА

> рЃћрЃА рЃљрЃарЃўрЃА рЃюрЃљрЃЉрЃўрЃ»-рЃюрЃљрЃЉрЃўрЃ» рЃљрЃ«рЃАрЃюрЃљ `micrograd_lecture_first_half_roughly.ipynb` рЃцрЃљрЃўрЃџрЃўрЃА, рЃЦрЃљрЃарЃЌрЃБрЃџ рЃћрЃюрЃљрЃќрЃћ, рЃўрЃАрЃћ рЃарЃЮрЃЏ рЃњрЃљрЃўрЃњрЃЮрЃА рЃАрЃЎрЃЮрЃџрЃўрЃА рЃЏрЃЮрЃАрЃгрЃљрЃЋрЃџрЃћрЃЏрЃљрЃф рЃЎрЃў.

---

## ­ЪЊќ рЃАрЃљрЃарЃЕрЃћрЃЋрЃў

1. [рЃерЃћрЃАрЃљрЃЋрЃљрЃџрЃў - рЃарЃљ рЃЋрЃўрЃАрЃгрЃљрЃЋрЃџрЃўрЃЌ?](#рЃерЃћрЃАрЃљрЃЋрЃљрЃџрЃў)
2. [рЃюрЃљрЃгрЃўрЃџрЃў 1: рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў рЃЊрЃљ рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃћрЃЉрЃў](#рЃюрЃљрЃгрЃўрЃџрЃў-1-рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў-рЃЊрЃљ-рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃћрЃЉрЃў)
3. [рЃюрЃљрЃгрЃўрЃџрЃў 2: Value рЃЎрЃџрЃљрЃАрЃў - рЃГрЃЎрЃЋрЃўрЃљрЃюрЃў рЃарЃўрЃфрЃ«рЃЋрЃћрЃЉрЃў](#рЃюрЃљрЃгрЃўрЃџрЃў-2-value-рЃЎрЃџрЃљрЃАрЃў)
4. [рЃюрЃљрЃгрЃўрЃџрЃў 3: Backpropagation](#рЃюрЃљрЃгрЃўрЃџрЃў-3-backpropagation)
5. [рЃюрЃљрЃгрЃўрЃџрЃў 4: рЃюрЃћрЃўрЃарЃЮрЃюрЃў](#рЃюрЃљрЃгрЃўрЃџрЃў-4-рЃюрЃћрЃўрЃарЃЮрЃюрЃў)
6. [рЃюрЃљрЃгрЃўрЃџрЃў 5: рЃАрЃљрЃЋрЃљрЃарЃ»рЃўрЃерЃЮрЃћрЃЉрЃў](#рЃюрЃљрЃгрЃўрЃџрЃў-5-рЃАрЃљрЃЋрЃљрЃарЃ»рЃўрЃерЃЮрЃћрЃЉрЃў)

---

## рЃерЃћрЃАрЃљрЃЋрЃљрЃџрЃў

### рЃарЃљ рЃЋрЃўрЃАрЃгрЃљрЃЋрЃџрЃўрЃЌ рЃљрЃЏ notebook-рЃерЃў?

рЃљрЃЏ notebook-рЃерЃў рЃЋрЃАрЃгрЃљрЃЋрЃџрЃЮрЃЉрЃЌ:
1. **рЃарЃЮрЃњрЃЮрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃЌрЃЋрЃљрЃџрЃЮрЃЌ рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў** (derivative) - рЃћрЃА рЃљрЃарЃўрЃА рЃАрЃљрЃцрЃБрЃФрЃЋрЃћрЃџрЃў AI-рЃўрЃАрЃЌрЃЋрЃўрЃА
2. **рЃарЃЮрЃњрЃЮрЃа рЃљрЃерЃћрЃюрЃЊрЃћрЃЉрЃљ "рЃГрЃЎрЃЋрЃўрЃљрЃюрЃў" рЃарЃўрЃфрЃ«рЃЋрЃћрЃЉрЃў** рЃарЃЮрЃЏрЃџрЃћрЃЉрЃЏрЃљрЃф рЃўрЃфрЃўрЃљрЃю рЃАрЃљрЃўрЃЊрЃљрЃю рЃЏрЃЮрЃЋрЃўрЃЊрЃюрЃћрЃю
3. **рЃарЃЮрЃњрЃЮрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА Backpropagation** - рЃћрЃА рЃљрЃарЃўрЃА "рЃЉрЃўрЃарЃЌрЃЋрЃБрЃџрЃў рЃўрЃљрЃарЃљрЃдрЃў" AI-рЃерЃў
4. **рЃарЃЮрЃњрЃЮрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА рЃћрЃарЃЌрЃў рЃюрЃћрЃўрЃарЃЮрЃюрЃў** - рЃбрЃЋрЃўрЃюрЃўрЃА рЃБрЃ»рЃарЃћрЃЊрЃўрЃА рЃўрЃЏрЃўрЃбрЃљрЃфрЃўрЃљ

---

## рЃюрЃљрЃгрЃўрЃџрЃў 1: рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў рЃЊрЃљ рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃћрЃЉрЃў

### ­ЪЊЮ Cell 0-1: рЃЉрЃўрЃЉрЃџрЃўрЃЮрЃЌрЃћрЃЎрЃћрЃЉрЃў рЃЊрЃљ рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ

```python
import math
import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline

def f(x):
  return 3*x**2 - 4*x + 5
```

**рЃарЃљрЃА рЃљрЃЎрЃћрЃЌрЃћрЃЉрЃА рЃћрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ?**

`f(x) = 3x┬▓ - 4x + 5` - рЃћрЃА рЃљрЃарЃўрЃА **рЃЎрЃЋрЃљрЃЊрЃарЃљрЃбрЃБрЃџрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ** (parabola).

рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ:
- рЃЌрЃБ `x = 3`, рЃЏрЃљрЃерЃўрЃю `f(3) = 3├Ќ9 - 4├Ќ3 + 5 = 27 - 12 + 5 = 20`

---

### ­ЪЊі Cell 2-3: рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃА рЃЋрЃўрЃќрЃБрЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃљ

```python
f(3.0)  # рЃерЃћрЃЊрЃћрЃњрЃў: 20.0

xs = np.arange(-5, 5, 0.25)  # x-рЃћрЃЉрЃў -5-рЃЊрЃљрЃю 5-рЃЏрЃЊрЃћ
ys = f(xs)                     # f(x)-рЃћрЃЉрЃў рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў x-рЃАрЃЌрЃЋрЃўрЃА
plt.plot(xs, ys)               # рЃњрЃарЃљрЃцрЃўрЃЎрЃў
```

**рЃарЃљрЃА рЃЋрЃ«рЃћрЃЊрЃљрЃЋрЃЌ?**

рЃњрЃарЃљрЃцрЃўрЃЎрЃќрЃћ рЃЋрЃ«рЃћрЃЊрЃљрЃЋрЃЌ рЃърЃљрЃарЃљрЃЉрЃЮрЃџрЃљрЃА:
```
  y
  Рћѓ     РЋ▒РћђРћђРЋ▓
25Рћѓ    РЋ▒    РЋ▓
  Рћѓ   РЋ▒      РЋ▓
  Рћѓ  РЋ▒        РЋ▓
 5РћюРћђРћђ          РћђРћђ
  Рћѓ
  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђ x
  -5    0     5
```

рЃћрЃА рЃњрЃарЃљрЃцрЃўрЃЎрЃў рЃњрЃЋрЃўрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃарЃЮрЃњрЃЮрЃа рЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ y рЃарЃЮрЃфрЃљ x рЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ.

---

### ­Ъћг Cell 4: рЃюрЃўрЃБрЃЏрЃћрЃарЃБрЃџрЃў рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў (рЃ«рЃћрЃџрЃўрЃЌ)

```python
h = 0.000001
x = 2/3
(f(x + h) - f(x))/h
```

**рЃарЃљ рЃљрЃарЃўрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў?**

рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў рЃњрЃћрЃБрЃЉрЃюрЃћрЃЉрЃљ: **"рЃарЃљрЃЏрЃЊрЃћрЃюрЃљрЃЊ рЃАрЃгрЃарЃљрЃцрЃљрЃЊ рЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃљрЃЏ рЃгрЃћрЃарЃбрЃўрЃџрЃерЃў?"**

**рЃљрЃюрЃљрЃџрЃЮрЃњрЃўрЃљ:** рЃгрЃљрЃарЃЏрЃЮрЃўрЃЊрЃњрЃўрЃюрЃћ рЃЏрЃљрЃюрЃЦрЃљрЃюрЃљ:
- **f(x)** = рЃАрЃљрЃЊ рЃ«рЃљрЃа (рЃърЃЮрЃќрЃўрЃфрЃўрЃљ)
- **f'(x)** = рЃарЃљ рЃАрЃўрЃЕрЃЦрЃљрЃарЃўрЃЌ рЃЏрЃўрЃЊрЃўрЃ«рЃљрЃа (рЃАрЃўрЃЕрЃЦрЃљрЃарЃћ)

**рЃарЃЮрЃњрЃЮрЃа рЃЋрЃЌрЃЋрЃџрЃўрЃЌ рЃ«рЃћрЃџрЃўрЃЌ?**

1. рЃљрЃўрЃдрЃћ рЃърЃљрЃбрЃљрЃарЃљ рЃюрЃљрЃЉрЃўрЃ»рЃў `h` (рЃЏрЃљрЃњ: 0.000001)
2. рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃљрЃџрЃћ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ `x`-рЃерЃў: `f(x)`
3. рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃљрЃџрЃћ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ `x+h`-рЃерЃў: `f(x+h)`
4. рЃњрЃљрЃДрЃљрЃЋрЃў рЃАрЃ«рЃЋрЃљрЃЮрЃЉрЃљ `h`-рЃќрЃћ: `(f(x+h) - f(x)) / h`

рЃћрЃА рЃљрЃарЃўрЃА **рЃфрЃўрЃфрЃљрЃЉрЃЮ** (slope) рЃўрЃЏ рЃгрЃћрЃарЃбрЃўрЃџрЃерЃў!

**рЃЏрЃљрЃЌрЃћрЃЏрЃљрЃбрЃўрЃЎрЃБрЃарЃљрЃЊ:**
```
f'(x) = lim[hРєњ0] (f(x+h) - f(x)) / h
```

рЃЕрЃЋрЃћрЃю рЃЋрЃўрЃДрЃћрЃюрЃћрЃЉрЃЌ рЃФрЃљрЃџрЃўрЃљрЃю рЃърЃљрЃбрЃљрЃарЃљ `h`-рЃА (0.000001) рЃарЃЮрЃЏ рЃЏрЃўрЃЋрЃљрЃљрЃ«рЃџрЃЮрЃЋрЃЊрЃћрЃЌ рЃљрЃЏ рЃџрЃўрЃЏрЃўрЃбрЃА.

---

### ­ЪД« Cell 5-6: рЃарЃЌрЃБрЃџрЃў рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў

```python
# Cell 5: рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃљ
a = 2.0
b = -3.0
c = 10.0
d = a*b + c
print(d)  # рЃерЃћрЃЊрЃћрЃњрЃў: 4.0
```

рЃћрЃА рЃърЃўрЃарЃЊрЃљрЃърЃўрЃарЃў рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃљрЃљ: `d = 2├Ќ(-3) + 10 = -6 + 10 = 4`

```python
# Cell 6: c-рЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў
h = 0.0001

a = 2.0
b = -3.0
c = 10.0

d1 = a*b + c        # d1 = 4.0
c += h              # c рЃњрЃљрЃ«рЃЊрЃљ 10.0001
d2 = a*b + c        # d2 = 4.0001

print('slope', (d2 - d1)/h)  # рЃерЃћрЃЊрЃћрЃњрЃў: РЅѕ 1.0
```

**рЃарЃљрЃА рЃюрЃўрЃерЃюрЃљрЃЋрЃА рЃћрЃА?**

рЃЋрЃћрЃЎрЃўрЃЌрЃ«рЃћрЃЉрЃўрЃЌ: "рЃЌрЃБ `c`-рЃА рЃерЃћрЃЋрЃфрЃЋрЃџрЃўрЃЌ 0.0001-рЃўрЃЌ, рЃарЃЮрЃњрЃЮрЃа рЃерЃћрЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ `d`?"

рЃърЃљрЃАрЃБрЃ«рЃў: `РЅѕ 1.0` - рЃљрЃюрЃБ **dd/dc = 1**

**рЃарЃљрЃбрЃЮрЃЏ?**
рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ `d = a├Ќb + c`, рЃ«рЃЮрЃџрЃЮ `a` рЃЊрЃљ `b` рЃљрЃа рЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ, рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ `c` рЃћрЃЏрЃљрЃбрЃћрЃЉрЃљ!
рЃљрЃАрЃћ рЃарЃЮрЃЏ `c`-рЃА рЃДрЃЮрЃЋрЃћрЃџрЃў рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ 1:1 рЃњрЃљрЃЊрЃљрЃЊрЃўрЃА `d`-рЃќрЃћ.

---

## рЃюрЃљрЃгрЃўрЃџрЃў 2: Value рЃЎрЃџрЃљрЃАрЃў

### ­Ъј» Cell 7: Value рЃЎрЃџрЃљрЃАрЃў - рЃарЃћрЃЋрЃЮрЃџрЃБрЃфрЃўрЃљ!

рЃћрЃА рЃљрЃарЃўрЃА рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃюрЃљрЃгрЃўрЃџрЃў! рЃЏрЃЮрЃЊрЃўрЃЌ рЃЊрЃљрЃЋрЃерЃљрЃџрЃЮрЃЌ рЃюрЃљрЃЉрЃўрЃ»-рЃюрЃљрЃЉрЃўрЃ»:

```python
class Value:

  def __init__(self, data, _children=(), _op='', label=''):
    self.data = data           # рЃарЃћрЃљрЃџрЃБрЃарЃў рЃарЃўрЃфрЃ«рЃЋрЃў
    self.grad = 0.0            # рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃў (рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў)
    self._backward = lambda: None  # рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ backprop-рЃўрЃАрЃЌрЃЋрЃўрЃА
    self._prev = set(_children)    # рЃАрЃљрЃўрЃЊрЃљрЃю рЃЏрЃЮрЃЋрЃўрЃЊрЃљ
    self._op = _op                 # рЃарЃљ рЃЮрЃърЃћрЃарЃљрЃфрЃўрЃљ (+, *, tanh)
    self.label = label             # рЃАрЃљрЃ«рЃћрЃџрЃў (a, b, c...)
```

**рЃарЃљ рЃљрЃарЃўрЃА Value?**

`Value` рЃљрЃарЃўрЃА "рЃГрЃЎрЃЋрЃўрЃљрЃюрЃў рЃарЃўрЃфрЃ«рЃЋрЃў" рЃарЃЮрЃЏрЃћрЃџрЃўрЃф:
1. РюЁ рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃарЃўрЃфрЃ«рЃЋрЃА (`data`)
2. РюЁ рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃўрЃАрЃбрЃЮрЃарЃўрЃљрЃА (рЃАрЃљрЃўрЃЊрЃљрЃю рЃЏрЃЮрЃЋрЃўрЃЊрЃљ - `_prev`)
3. РюЁ рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃА (`grad`)
4. РюЁ рЃўрЃфрЃўрЃА рЃарЃЮрЃњрЃЮрЃа рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃљрЃџрЃЮрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў рЃБрЃЎрЃљрЃю (`_backward`)

---

### РъЋ рЃерЃћрЃЎрЃарЃћрЃЉрЃљ (Addition)

```python
def __add__(self, other):
    out = Value(self.data + other.data, (self, other), '+')

    def _backward():
      self.grad += 1.0 * out.grad
      other.grad += 1.0 * out.grad
    out._backward = _backward

    return out
```

**рЃЏрЃЮрЃЊрЃўрЃЌ рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃќрЃћ:**

```python
a = Value(2.0)
b = Value(3.0)
c = a + b  # c.data = 5.0
```

рЃарЃљ рЃ«рЃЊрЃћрЃЉрЃљ рЃљрЃЦ?
1. рЃўрЃЦрЃЏрЃюрЃћрЃЉрЃљ рЃљрЃ«рЃљрЃџрЃў `Value` рЃарЃЮрЃЏрЃџрЃўрЃА `data = 2.0 + 3.0 = 5.0`
2. рЃљрЃЏ Value-рЃА рЃљрЃ«рЃАрЃЮрЃЋрЃА рЃарЃЮрЃЏ рЃЏрЃЮрЃЋрЃўрЃЊрЃљ `a`-рЃАрЃњрЃљрЃю рЃЊрЃљ `b`-рЃАрЃњрЃљрЃю
3. рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃљрЃА `_backward` рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃўрЃфрЃўрЃА: "рЃЌрЃБ `c` рЃерЃћрЃфрЃЊрЃЮрЃЏрЃљрЃА рЃЏрЃўрЃўрЃдрЃћрЃЉрЃА, рЃћрЃА рЃерЃћрЃфрЃЊрЃЮрЃЏрЃљ рЃЌрЃљрЃюрЃљрЃЉрЃарЃљрЃЊ рЃњрЃљрЃўрЃДрЃљрЃЋрЃўрЃЌ `a`-рЃАрЃљ рЃЊрЃљ `b`-рЃќрЃћ"

**рЃЏрЃљрЃЌрЃћрЃЏрЃљрЃбрЃўрЃЎрЃљ:**
```
рЃЌрЃБ c = a + b
рЃЏрЃљрЃерЃўрЃю: dc/da = 1  (a-рЃА рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа рЃњрЃљрЃЊрЃљрЃЊрЃўрЃА c-рЃќрЃћ)
       dc/db = 1  (b-рЃф рЃљрЃАрЃћрЃЋрЃћ)
```

---

### Рюќ№ИЈ рЃњрЃљрЃЏрЃарЃљрЃЋрЃџрЃћрЃЉрЃљ (Multiplication)

```python
def __mul__(self, other):
    out = Value(self.data * other.data, (self, other), '*')

    def _backward():
      self.grad += other.data * out.grad
      other.grad += self.data * out.grad
    out._backward = _backward

    return out
```

**рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў:**

```python
a = Value(2.0)
b = Value(3.0)
c = a * b  # c.data = 6.0
```

**рЃЏрЃљрЃЌрЃћрЃЏрЃљрЃбрЃўрЃЎрЃљ:**
```
рЃЌрЃБ c = a ├Ќ b
рЃЏрЃљрЃерЃўрЃю: dc/da = b  (a-рЃА рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ b-рЃ»рЃћрЃа рЃњрЃљрЃЊрЃўрЃЊрЃћрЃЉрЃБрЃџрЃў рЃњрЃљрЃЊрЃљрЃЊрЃўрЃА c-рЃќрЃћ)
       dc/db = a  (b-рЃА рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ a-рЃ»рЃћрЃа рЃњрЃљрЃЊрЃўрЃЊрЃћрЃЉрЃБрЃџрЃў рЃњрЃљрЃЊрЃљрЃЊрЃўрЃА c-рЃќрЃћ)
```

**рЃўрЃюрЃбрЃБрЃўрЃфрЃўрЃљ:**

рЃгрЃљрЃарЃЏрЃЮрЃўрЃЊрЃњрЃўрЃюрЃћ рЃЏрЃљрЃарЃЌрЃЎрЃБрЃЌрЃ«рЃћрЃЊрЃў:
- `a = рЃАрЃўрЃњрЃарЃФрЃћ = 2`
- `b = рЃАрЃўрЃњрЃљрЃюрЃћ = 3`
- `c = рЃцрЃљрЃарЃЌрЃЮрЃЉрЃў = 6`

рЃЌрЃБ рЃАрЃўрЃњрЃарЃФрЃћрЃА рЃерЃћрЃЋрЃфрЃЋрЃџрЃўрЃЌ 0.1-рЃўрЃЌ:
- рЃцрЃљрЃарЃЌрЃЮрЃЉрЃў рЃњрЃљрЃўрЃќрЃарЃЊрЃћрЃЉрЃљ `0.1 ├Ќ рЃАрЃўрЃњрЃљрЃюрЃћ = 0.1 ├Ќ 3 = 0.3`-рЃўрЃЌ!

рЃљрЃЏрЃўрЃбрЃЮрЃЏ `dc/da = b = 3`!

---

### ­ЪЊѕ tanh - рЃљрЃЦрЃбрЃўрЃЋрЃљрЃфрЃўрЃўрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ

```python
def tanh(self):
    x = self.data
    t = (math.exp(2*x) - 1)/(math.exp(2*x) + 1)
    out = Value(t, (self, ), 'tanh')

    def _backward():
      self.grad += (1 - t**2) * out.grad
    out._backward = _backward

    return out
```

**рЃарЃљ рЃљрЃарЃўрЃА tanh?**

`tanh` (hyperbolic tangent) рЃљрЃарЃўрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃарЃЮрЃЏрЃћрЃџрЃўрЃф:
- рЃўрЃдрЃћрЃЉрЃА рЃюрЃћрЃЉрЃўрЃАрЃЏрЃўрЃћрЃа рЃарЃўрЃфрЃ«рЃЋрЃА
- рЃљрЃЉрЃарЃБрЃюрЃћрЃЉрЃА рЃарЃўрЃфрЃ«рЃЋрЃА -1-рЃЊрЃљрЃю 1-рЃЏрЃЊрЃћ

**рЃњрЃарЃљрЃцрЃўрЃЎрЃў:**
```
    1.0 Рћц        РЋГРћђРћђРћђРћђРћђРћђРћђРћђ
        Рћѓ      РЋ▒
        Рћѓ    РЋ▒
    0.0 Рћц  РЋ▒
        Рћѓ РЋ▒
        РћѓРЋ▒
   -1.0 РћцРћђРћђРћђРћђРћђРћђРћђРћђРЋ»
        РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђ
       -5   0   5
```

**рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃћрЃЉрЃў:**
- `tanh(-100) РЅѕ -1` (рЃФрЃљрЃџрЃўрЃљрЃю рЃБрЃљрЃарЃДрЃЮрЃцрЃўрЃЌрЃў Рєњ -1)
- `tanh(0) = 0` (рЃюрЃБрЃџрЃў Рєњ рЃюрЃБрЃџрЃў)
- `tanh(100) РЅѕ 1` (рЃФрЃљрЃџрЃўрЃљрЃю рЃЊрЃљрЃЊрЃћрЃЉрЃўрЃЌрЃў Рєњ 1)

**рЃарЃљрЃбрЃЮрЃЏ рЃњрЃЋрЃГрЃўрЃарЃЊрЃћрЃЉрЃљ?**

рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџ рЃЦрЃАрЃћрЃџрЃћрЃЉрЃерЃў рЃњрЃЋрЃГрЃўрЃарЃЊрЃћрЃЉрЃљ "рЃњрЃљрЃЏрЃЮрЃарЃЌрЃЋрЃљ/рЃЕрЃљрЃарЃЌрЃЋрЃљ" рЃЏрЃћрЃЦрЃљрЃюрЃўрЃќрЃЏрЃў. `tanh` рЃљрЃЏрЃљрЃА рЃљрЃЎрЃћрЃЌрЃћрЃЉрЃА:
- рЃБрЃљрЃарЃДрЃЮрЃцрЃўрЃЌрЃў Рєњ "рЃњрЃљрЃЏрЃЮрЃарЃЌрЃБрЃџрЃў" (-1)
- рЃюрЃћрЃўрЃбрЃарЃљрЃџрЃБрЃарЃў Рєњ "рЃерЃБрЃљрЃерЃў" (0)
- рЃЊрЃљрЃЊрЃћрЃЉрЃўрЃЌрЃў Рєњ "рЃЕрЃљрЃарЃЌрЃБрЃџрЃў" (1)

**рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў:**
```
d(tanh(x))/dx = 1 - tanh┬▓(x)
```

рЃарЃљрЃбрЃЮрЃЏ рЃљрЃарЃўрЃА рЃћрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў?
- рЃЌрЃБ `tanh(x) РЅѕ ┬▒1` (рЃњрЃљрЃ»рЃћрЃарЃћрЃЉрЃБрЃџрЃў), рЃЏрЃљрЃерЃўрЃю `1 - 1┬▓ = 0` Рєњ **рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃў рЃюрЃБрЃџрЃўрЃљ!**
- рЃЌрЃБ `tanh(x) РЅѕ 0` (рЃерЃБрЃљрЃерЃў), рЃЏрЃљрЃерЃўрЃю `1 - 0┬▓ = 1` Рєњ **рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃў рЃЏрЃљрЃЦрЃАрЃўрЃЏрЃљрЃџрЃБрЃарЃўрЃљ!**

---

### ­Ъћё backward() - рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃЏрЃљрЃњрЃўрЃљ!

```python
def backward(self):

    topo = []
    visited = set()
    def build_topo(v):
      if v not in visited:
        visited.add(v)
        for child in v._prev:
          build_topo(child)
        topo.append(v)
    build_topo(self)

    self.grad = 1.0
    for node in reversed(topo):
      node._backward()
```

**рЃарЃљрЃА рЃљрЃЎрЃћрЃЌрЃћрЃЉрЃА `backward()`?**

рЃћрЃА рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃўрЃА **рЃДрЃЋрЃћрЃџрЃљ рЃфрЃЋрЃџрЃљрЃЊрЃўрЃА рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃА**.

**рЃюрЃљрЃЉрЃўрЃ»рЃћрЃЉрЃў:**

**1. Topological Sort (рЃбрЃЮрЃърЃЮрЃџрЃЮрЃњрЃўрЃБрЃарЃў рЃЊрЃљрЃ«рЃљрЃарЃўрЃАрЃ«рЃћрЃЉрЃљ):**

рЃгрЃљрЃарЃЏрЃЮрЃўрЃЊрЃњрЃўрЃюрЃћ рЃЏрЃерЃЮрЃЉрЃџрЃћрЃЉрЃў рЃЊрЃљ рЃерЃЋрЃўрЃџрЃћрЃЉрЃў:
```
    a       b
     \     /
      \   /
       \ /
        c
        |
        d
```

рЃбрЃЮрЃърЃЮрЃџрЃЮрЃњрЃўрЃБрЃарЃў рЃАрЃЮрЃарЃбрЃў: `[a, b, c, d]` - рЃърЃўрЃарЃЋрЃћрЃџ рЃарЃўрЃњрЃерЃў "рЃЏрЃерЃЮрЃЉрЃџрЃћрЃЉрЃў", рЃерЃћрЃЏрЃЊрЃћрЃњ "рЃерЃЋрЃўрЃџрЃћрЃЉрЃў".

**рЃарЃљрЃбрЃЮрЃЏ?** рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ backprop-рЃерЃў рЃБрЃюрЃЊрЃљ рЃЊрЃљрЃЋрЃўрЃгрЃДрЃЮрЃЌ рЃЉрЃЮрЃџрЃЮрЃЊрЃљрЃю рЃЊрЃљ рЃгрЃљрЃЋрЃўрЃЊрЃћрЃЌ рЃАрЃљрЃгрЃДрЃўрЃАрЃўрЃАрЃЎрЃћрЃю!

**2. рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ grad = 1.0:**

рЃЉрЃЮрЃџрЃЮ output-рЃА рЃЋрЃБрЃгрЃћрЃарЃЌ `grad = 1.0`. рЃћрЃА рЃюрЃўрЃерЃюрЃљрЃЋрЃА: "рЃћрЃА рЃљрЃарЃўрЃА рЃЕрЃЋрЃћрЃюрЃў рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃАрЃљрЃЏрЃўрЃќрЃюрЃћ".

**3. Reversed Iteration:**

рЃБрЃЎрЃљрЃю рЃњрЃљрЃЊрЃљрЃЋрЃЊрЃўрЃЋрЃљрЃарЃЌ рЃЊрЃљ рЃЋрЃЌрЃ«рЃЮрЃЋрЃЌ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџ node-рЃА: "рЃњрЃљрЃљрЃЋрЃарЃфрЃћрЃџрЃћ рЃерЃћрЃюрЃў grad рЃерЃћрЃюрЃА рЃерЃЋрЃўрЃџрЃћрЃЉрЃќрЃћ!"

```python
for node in reversed(topo):
    node._backward()
```

---

### ­ЪїЪ рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў - рЃАрЃарЃБрЃџрЃў рЃърЃарЃЮрЃфрЃћрЃАрЃў

```python
a = Value(2.0, label='a')
b = Value(-3.0, label='b')
c = Value(10.0, label='c')
e = a*b; e.label = 'e'
d = e + c; d.label = 'd'
f = Value(-2.0, label='f')
L = d * f; L.label = 'L'
L
```

**Forward Pass (рЃгрЃўрЃю рЃњрЃљрЃЋрЃЊрЃўрЃЋрЃљрЃарЃЌ):**

1. `e = a ├Ќ b = 2 ├Ќ (-3) = -6`
2. `d = e + c = -6 + 10 = 4`
3. `L = d ├Ќ f = 4 ├Ќ (-2) = -8`

**рЃерЃћрЃЊрЃћрЃњрЃў:** `L.data = -8`

**рЃљрЃ«рЃџрЃљ рЃЋрЃўрЃЌрЃ«рЃЮрЃЋрЃЮрЃЌ рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃў:**

```python
L.backward()
```

**рЃарЃљ рЃ«рЃЊрЃћрЃЉрЃљ рЃБрЃЎрЃљрЃю?**

1. **L.grad = 1.0** (рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ output)

2. **L._backward() рЃњрЃљрЃЏрЃЮрЃўрЃФрЃљрЃ«рЃћрЃЉрЃљ:**
   ```python
   # L = d ├Ќ f, рЃљрЃАрЃћ рЃарЃЮрЃЏ:
   d.grad += f.data ├Ќ L.grad = -2 ├Ќ 1.0 = -2
   f.grad += d.data ├Ќ L.grad = 4 ├Ќ 1.0 = 4
   ```

3. **d._backward() рЃњрЃљрЃЏрЃЮрЃўрЃФрЃљрЃ«рЃћрЃЉрЃљ:**
   ```python
   # d = e + c, рЃљрЃАрЃћ рЃарЃЮрЃЏ:
   e.grad += 1.0 ├Ќ d.grad = 1.0 ├Ќ (-2) = -2
   c.grad += 1.0 ├Ќ d.grad = 1.0 ├Ќ (-2) = -2
   ```

4. **e._backward() рЃњрЃљрЃЏрЃЮрЃўрЃФрЃљрЃ«рЃћрЃЉрЃљ:**
   ```python
   # e = a ├Ќ b, рЃљрЃАрЃћ рЃарЃЮрЃЏ:
   a.grad += b.data ├Ќ e.grad = -3 ├Ќ (-2) = 6
   b.grad += a.data ├Ќ e.grad = 2 ├Ќ (-2) = -4
   ```

**рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў:**
- `a.grad = 6` Рєњ "рЃЌрЃБ `a`-рЃА 0.1-рЃўрЃЌ рЃњрЃљрЃЋрЃќрЃарЃЊрЃў, `L` 0.6-рЃўрЃЌ рЃњрЃљрЃўрЃќрЃарЃЊрЃћрЃЉрЃљ"
- `b.grad = -4` Рєњ "рЃЌрЃБ `b`-рЃА 0.1-рЃўрЃЌ рЃњрЃљрЃЋрЃќрЃарЃЊрЃў, `L` 0.4-рЃўрЃЌ рЃерЃћрЃЏрЃфрЃўрЃарЃЊрЃћрЃЉрЃљ"
- `c.grad = -2` Рєњ "рЃЌрЃБ `c`-рЃА 0.1-рЃўрЃЌ рЃњрЃљрЃЋрЃќрЃарЃЊрЃў, `L` 0.2-рЃўрЃЌ рЃерЃћрЃЏрЃфрЃўрЃарЃЊрЃћрЃЉрЃљ"
- `f.grad = 4` Рєњ "рЃЌрЃБ `f`-рЃА 0.1-рЃўрЃЌ рЃњрЃљрЃЋрЃќрЃарЃЊрЃў, `L` 0.4-рЃўрЃЌ рЃњрЃљрЃўрЃќрЃарЃЊрЃћрЃЉрЃљ"

---

## рЃюрЃљрЃгрЃўрЃџрЃў 3: Backpropagation

### ­Ъје Cell 8-9: рЃЋрЃўрЃќрЃБрЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃљ

```python
from graphviz import Digraph

def trace(root):
  nodes, edges = set(), set()
  def build(v):
    if v not in nodes:
      nodes.add(v)
      for child in v._prev:
        edges.add((child, v))
        build(child)
  build(root)
  return nodes, edges

def draw_dot(root):
  dot = Digraph(format='svg', graph_attr={'rankdir': 'LR'})

  nodes, edges = trace(root)
  for n in nodes:
    uid = str(id(n))
    dot.node(name = uid, label = "{ %s | data %.4f | grad %.4f }" % (n.label, n.data, n.grad), shape='record')
    if n._op:
      dot.node(name = uid + n._op, label = n._op)
      dot.edge(uid + n._op, uid)

  for n1, n2 in edges:
    dot.edge(str(id(n1)), str(id(n2)) + n2._op)

  return dot

draw_dot(L)
```

**рЃарЃљрЃА рЃљрЃЎрЃћрЃЌрЃћрЃЉрЃА `draw_dot()`?**

рЃЦрЃЏрЃюрЃўрЃА рЃЋрЃўрЃќрЃБрЃљрЃџрЃБрЃа рЃњрЃарЃљрЃцрЃА, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃњрЃЋрЃўрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА:
1. **nodes (рЃЎрЃЋрЃљрЃюрЃФрЃћрЃЉрЃў):** рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў Value
2. **edges (рЃЎрЃўрЃЊрЃћрЃћрЃЉрЃў):** рЃЋрЃўрЃю рЃЊрЃљрЃЎрЃљрЃЋрЃерЃўрЃарЃћрЃЉрЃБрЃџрЃўрЃљ рЃЋрЃўрЃАрЃЌрЃљрЃю
3. **data:** рЃарЃўрЃфрЃ«рЃЋрЃўрЃЌрЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ
4. **grad:** рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃў

**рЃерЃћрЃЊрЃћрЃњрЃў рЃљрЃАрЃћ рЃњрЃљрЃЏрЃЮрЃўрЃДрЃБрЃарЃћрЃЉрЃљ:**

```
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ      РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ a       Рћѓ      Рћѓ b       Рћѓ
Рћѓ data: 2 Рћѓ      Рћѓ data: -3Рћѓ
Рћѓ grad: 6 Рћѓ      Рћѓ grad: -4Рћѓ
РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў      РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў
     Рћѓ                Рћѓ
     РћћРћђРћђРћђРћђРћљ   РћїРћђРћђРћђРћђРћђРћђРћђРћў
          Рћѓ   Рћѓ
          Рќ╝   Рќ╝
     РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
     Рћѓ    ├Ќ    Рћѓ
     РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў
          Рћѓ
          Рќ╝
     РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ      РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
     Рћѓ e       Рћѓ      Рћѓ c       Рћѓ
     Рћѓ data: -6Рћѓ      Рћѓ data: 10Рћѓ
     Рћѓ grad: -2Рћѓ      Рћѓ grad: -2Рћѓ
     РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў      РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў
          Рћѓ                Рћѓ
          РћћРћђРћђРћђРћђРћљ   РћїРћђРћђРћђРћђРћђРћђРћђРћў
               Рћѓ   Рћѓ
               Рќ╝   Рќ╝
          РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
          Рћѓ    +    Рћѓ
          РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў
               Рћѓ
               Рќ╝
          РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ      РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
          Рћѓ d       Рћѓ      Рћѓ f       Рћѓ
          Рћѓ data: 4 Рћѓ      Рћѓ data: -2Рћѓ
          Рћѓ grad: -2Рћѓ      Рћѓ grad: 4 Рћѓ
          РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў      РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў
               Рћѓ                Рћѓ
               РћћРћђРћђРћђРћђРћљ   РћїРћђРћђРћђРћђРћђРћђРћђРћў
                    Рћѓ   Рћѓ
                    Рќ╝   Рќ╝
               РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
               Рћѓ    ├Ќ    Рћѓ
               РћћРћђРћђРћђРћђРћгРћђРћђРћђРћђРћў
                    Рћѓ
                    Рќ╝
               РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
               Рћѓ L       Рћѓ
               Рћѓ data: -8Рћѓ
               Рћѓ grad: 1 Рћѓ
               РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
```

---

### ­Ъј» Cell 10: Gradient Descent - рЃАрЃгрЃљрЃЋрЃџрЃљ!

```python
a.data += 0.01 * a.grad
b.data += 0.01 * b.grad
c.data += 0.01 * c.grad
f.data += 0.01 * f.grad

e = a * b
d = e + c
L = d * f

print(L.data)  # рЃерЃћрЃЊрЃћрЃњрЃў: -7.286496
```

**рЃарЃљ рЃЏрЃЮрЃ«рЃЊрЃљ?**

1. **рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ:** рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃфрЃЋрЃџрЃљрЃЊрЃў рЃњрЃљрЃюрЃЋрЃљрЃљрЃ«рЃџрЃћрЃЌ рЃЏрЃўрЃАрЃў grad-рЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ
2. **рЃ«рЃћрЃџрЃљрЃ«рЃљрЃџрЃў рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃљ:** рЃљрЃ«рЃљрЃџрЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃўрЃЌ рЃ«рЃћрЃџрЃљрЃ«рЃџрЃљ рЃњрЃљрЃЏрЃЮрЃЋрЃЌрЃЋрЃљрЃџрЃћрЃЌ L
3. **рЃерЃћрЃЊрЃћрЃњрЃў рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃЊрЃљ:** `-8 Рєњ -7.286` (рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ рЃњрЃљрЃўрЃќрЃљрЃарЃЊрЃљ!)

**рЃарЃљрЃбрЃЮрЃЏ?**
рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃфрЃЋрЃџрЃљрЃЊрЃў рЃњрЃљрЃЊрЃљрЃЋрЃљрЃљрЃЊрЃњрЃўрЃџрЃћрЃЌ рЃўрЃЏ рЃЏрЃўрЃЏрЃљрЃарЃЌрЃБрЃџрЃћрЃЉрЃўрЃЌ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃќрЃарЃЊрЃўрЃА `L`-рЃА!

**рЃарЃЮрЃЏ рЃњрЃЋрЃўрЃюрЃЊрЃЮрЃЊрЃљ `L`-рЃўрЃА рЃерЃћрЃЏрЃфрЃўрЃарЃћрЃЉрЃљ, рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃћрЃЉрЃЊрЃўрЃЌ:**
```python
a.data -= 0.01 * a.grad  # MINUS рЃюрЃўрЃерЃљрЃюрЃў!
```

рЃћрЃА рЃљрЃарЃўрЃА **Gradient Descent** - рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃўрЃА рЃАрЃљрЃгрЃўрЃюрЃљрЃљрЃдрЃЏрЃЊрЃћрЃњрЃЮрЃЊ рЃАрЃЋрЃџрЃљ!

---

### ­ЪДф Cell 11: рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃўрЃА рЃерЃћрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃљ рЃ«рЃћрЃџрЃўрЃЌ

```python
def lol():
  h = 0.001

  # рЃАрЃљрЃгрЃДрЃўрЃАрЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў
  a = Value(2.0, label='a')
  b = Value(-3.0, label='b')
  c = Value(10.0, label='c')
  e = a*b; e.label = 'e'
  d = e + c; d.label = 'd'
  f = Value(-2.0, label='f')
  L = d * f; L.label = 'L'
  L1 = L.data

  # b-рЃА рЃфрЃЮрЃбрЃљ рЃерЃћрЃЋрЃфрЃЋрЃџрЃўрЃЌ
  a = Value(2.0, label='a')
  b = Value(-3.0, label='b')
  b.data += h  # b рЃњрЃљрЃ«рЃЊрЃљ -2.999
  c = Value(10.0, label='c')
  e = a*b; e.label = 'e'
  d = e + c; d.label = 'd'
  f = Value(-2.0, label='f')
  L = d * f; L.label = 'L'
  L2 = L.data

  print((L2 - L1)/h)  # рЃерЃћрЃЊрЃћрЃњрЃў: -3.999... РЅѕ -4.0

lol()
```

**рЃарЃљрЃА рЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃА рЃћрЃА рЃЎрЃЮрЃЊрЃў?**

рЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃА: "рЃюрЃљрЃЏрЃЊрЃЋрЃўрЃџрЃљрЃЊ рЃљрЃарЃўрЃА `b.grad = -4`?"

**рЃарЃЮрЃњрЃЮрЃа?**
1. рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃљрЃџрЃћрЃЌ L рЃАрЃљрЃгрЃДрЃўрЃАрЃў b-рЃЌрЃў: `L1 = -8`
2. b-рЃА рЃфрЃЮрЃбрЃљ рЃњрЃљрЃќрЃљрЃарЃЊрЃћрЃЌ: `b = -3 + 0.001 = -2.999`
3. рЃ«рЃћрЃџрЃљрЃ«рЃџрЃљ рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃљрЃџрЃћрЃЌ L: `L2 РЅѕ -7.996`
4. рЃњрЃљрЃДрЃљрЃЋрЃўрЃЌ рЃАрЃ«рЃЋрЃљрЃЮрЃЉрЃљ h-рЃќрЃћ: `(L2 - L1) / h = (-7.996 - (-8)) / 0.001 = 0.004 / 0.001 = 4.0`

**рЃљрЃ░рЃљ!** b-рЃА grad рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА `-4`, рЃЊрЃљ рЃюрЃБрЃЏрЃћрЃарЃБрЃџрЃљрЃЊ рЃЏрЃўрЃЋрЃўрЃдрЃћрЃЌ `-4.0`! РюЁ

рЃћрЃА рЃљрЃЏрЃбрЃЎрЃўрЃфрЃћрЃЉрЃА рЃарЃЮрЃЏ рЃЕрЃЋрЃћрЃюрЃў backpropagation рЃАрЃгрЃЮрЃарЃўрЃљ!

---

## рЃюрЃљрЃгрЃўрЃџрЃў 4: рЃюрЃћрЃўрЃарЃЮрЃюрЃў

### ­ЪДа Cell 13-15: рЃарЃћрЃљрЃџрЃБрЃарЃў рЃюрЃћрЃўрЃарЃЮрЃюрЃў

```python
# inputs x1,x2
x1 = Value(2.0, label='x1')
x2 = Value(0.0, label='x2')

# weights w1,w2
w1 = Value(-3.0, label='w1')
w2 = Value(1.0, label='w2')

# bias
b = Value(6.8813735870195432, label='b')

# рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃљ
x1w1 = x1*w1; x1w1.label = 'x1*w1'
x2w2 = x2*w2; x2w2.label = 'x2*w2'
x1w1x2w2 = x1w1 + x2w2; x1w1x2w2.label = 'x1*w1 + x2*w2'
n = x1w1x2w2 + b; n.label = 'n'
o = n.tanh(); o.label = 'o'

draw_dot(o)
o.backward()
```

**рЃарЃљ рЃљрЃарЃўрЃА рЃћрЃА?**

рЃћрЃА рЃљрЃарЃўрЃА **рЃћрЃарЃЌрЃў рЃюрЃћрЃўрЃарЃЮрЃюрЃў** - рЃбрЃЋрЃўрЃюрЃўрЃА рЃБрЃ»рЃарЃћрЃЊрЃўрЃА рЃЎрЃЮрЃЏрЃърЃўрЃБрЃбрЃћрЃарЃБрЃџрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў!

**рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ:**

```
        x1 (input) РћђРћђРћђРћгРћђРєњ ├Ќw1 РћђРћђРћђРћљ
                      Рћѓ          Рћѓ
                      Рћѓ          РћюРћђРєњ + РћђРћђРћђРћљ
                      Рћѓ          Рћѓ        Рћѓ
        x2 (input) РћђРћђРћђРћ┤РћђРєњ ├Ќw2 РћђРћђРћђРћў        РћюРћђРєњ + РћђРћђРћђРєњ tanh РћђРћђРћђРєњ o (output)
                                           Рћѓ
                      b (bias) РћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
```

**рЃцрЃЮрЃарЃЏрЃБрЃџрЃљ:**
```
o = tanh(x1├Ќw1 + x2├Ќw2 + b)
```

**рЃЎрЃЮрЃЏрЃърЃЮрЃюрЃћрЃюрЃбрЃћрЃЉрЃў:**

1. **Inputs (рЃерЃћрЃДрЃЋрЃљрЃюрЃљ):** `x1`, `x2` - рЃарЃљрЃф рЃюрЃћрЃўрЃарЃЮрЃюрЃА рЃћрЃњрЃќрЃљрЃЋрЃюрЃћрЃЉрЃљ
2. **Weights (рЃгрЃЮрЃюрЃћрЃЉрЃў):** `w1`, `w2` - рЃарЃљрЃЏрЃЊрЃћрЃюрЃљрЃЊ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃўрЃљ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў input
3. **Bias (рЃгрЃљрЃюрЃљрЃфрЃЋрЃџрЃћрЃЉрЃљ):** `b` - рЃАрЃљрЃЉрЃљрЃќрЃўрЃАрЃЮ рЃЊрЃЮрЃюрЃћ (threshold)
4. **Activation (рЃљрЃЦрЃбрЃўрЃЋрЃљрЃфрЃўрЃљ):** `tanh` - рЃњрЃљрЃЊрЃљрЃгрЃДрЃЋрЃћрЃбрЃўрЃџрЃћрЃЉрЃўрЃА рЃЏрЃўрЃдрЃћрЃЉрЃљ

**рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў:**

```python
# рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃљ:
x1w1 = 2.0 ├Ќ (-3.0) = -6.0
x2w2 = 0.0 ├Ќ 1.0 = 0.0
sum = -6.0 + 0.0 = -6.0
n = -6.0 + 6.88 = 0.88
o = tanh(0.88) РЅѕ 0.707
```

**Backward:**
```python
o.backward()

# рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў:
# x1.grad РЅѕ -1.5  (x1-рЃА рЃќрЃарЃЊрЃљ -> o-рЃА рЃерЃћрЃЏрЃфрЃўрЃарЃћрЃЉрЃљ)
# w1.grad РЅѕ 1.0   (w1-рЃА рЃќрЃарЃЊрЃљ -> o-рЃА рЃќрЃарЃЊрЃљ)
# b.grad РЅѕ 0.5    (b-рЃА рЃќрЃарЃЊрЃљ -> o-рЃА рЃќрЃарЃЊрЃљ)
```

---

### ­ЪЊі Cell 16-30: рЃюрЃљрЃЉрЃўрЃ»-рЃюрЃљрЃЉрЃўрЃ» Backpropagation

**Cell 16: рЃбрЃЮрЃърЃЮрЃџрЃЮрЃњрЃўрЃБрЃарЃў рЃАрЃЮрЃарЃбрЃў рЃ«рЃћрЃџрЃўрЃЌ**

```python
topo = []
visited = set()
def build_topo(v):
  if v not in visited:
    visited.add(v)
    for child in v._prev:
      build_topo(child)
    topo.append(v)
build_topo(o)
topo
```

рЃерЃћрЃЊрЃћрЃњрЃў: `[b, x1, w1, x1w1, x2, w2, x2w2, x1w1x2w2, n, o]`

рЃћрЃА рЃљрЃарЃўрЃА рЃАрЃгрЃЮрЃарЃў рЃЌрЃљрЃюрЃЏрЃўрЃЏрЃЊрЃћрЃЋрЃарЃЮрЃЉрЃљ backprop-рЃўрЃАрЃЌрЃЋрЃўрЃА (рЃАрЃљрЃгрЃДрЃўрЃАрЃўрЃЊрЃљрЃю рЃЉрЃЮрЃџрЃЮрЃЏрЃЊрЃћ).

---

**Cell 17-28: рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃљ рЃ«рЃћрЃџрЃўрЃЌ**

рЃћрЃА рЃБрЃ»рЃарЃћрЃЊрЃћрЃЉрЃў рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА **рЃарЃЮрЃњрЃЮрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА backprop рЃ«рЃћрЃџрЃўрЃЌ**, рЃюрЃљрЃЉрЃўрЃ»-рЃюрЃљрЃЉрЃўрЃ»:

```python
# 1. рЃЊрЃљрЃЋрЃўрЃгрЃДрЃЮрЃЌ рЃЉрЃЮрЃџрЃЮрЃЊрЃљрЃю
o.grad = 1.0

# 2. tanh-рЃўрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў
o._backward()  # n.grad = (1 - o.data┬▓) ├Ќ o.grad = 0.5

# 3. рЃерЃћрЃЎрЃарЃћрЃЉрЃўрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў
n._backward()  # x1w1x2w2.grad = 0.5, b.grad = 0.5

# 4. рЃЎрЃўрЃЊрЃћрЃЋ рЃерЃћрЃЎрЃарЃћрЃЉрЃўрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў
x1w1x2w2._backward()  # x1w1.grad = 0.5, x2w2.grad = 0.5

# 5. рЃњрЃљрЃЏрЃарЃљрЃЋрЃџрЃћрЃЉрЃўрЃА рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃћрЃЉрЃў
x1w1._backward()  # x1.grad = w1.data ├Ќ 0.5 = -1.5
                  # w1.grad = x1.data ├Ќ 0.5 = 1.0

x2w2._backward()  # x2.grad = w2.data ├Ќ 0.5 = 0.5
                  # w2.grad = x2.data ├Ќ 0.5 = 0.0
```

**Cell 29-30: tanh рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃўрЃА рЃерЃћрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃљ**

```python
1 - o.data**2  # рЃерЃћрЃЊрЃћрЃњрЃў: 0.5
# o = tanh(n)
# do/dn = 1 - o┬▓
```

---

## рЃюрЃљрЃгрЃўрЃџрЃў 5: рЃАрЃљрЃЋрЃљрЃарЃ»рЃўрЃерЃЮрЃћрЃЉрЃў

### ­ЪјЊ Cell 31: a + a - рЃарЃљ рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ?

```python
a = Value(3.0, label='a')
b = a + a   ; b.label = 'b'
b.backward()
draw_dot(b)
```

**рЃўрЃюрЃбрЃћрЃарЃћрЃАрЃљрЃюрЃЌрЃў!** рЃарЃљ рЃљрЃарЃўрЃА `a.grad`?

**рЃърЃљрЃАрЃБрЃ«рЃў:** `a.grad = 2.0`

**рЃарЃљрЃбрЃЮрЃЏ?**
рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ `b = a + a`, рЃ«рЃЮрЃџрЃЮ рЃерЃћрЃЎрЃарЃћрЃЉрЃљрЃерЃў:
```python
def _backward():
    self.grad += 1.0 * out.grad   # рЃърЃўрЃарЃЋрЃћрЃџрЃў "a"
    other.grad += 1.0 * out.grad  # рЃЏрЃћрЃЮрЃарЃћ "a"
```

рЃЏрЃљрЃњрЃарЃљрЃЏ `self` рЃЊрЃљ `other` рЃљрЃарЃўрЃА рЃћрЃарЃЌрЃў рЃЊрЃљ рЃўрЃњрЃўрЃЋрЃћ `a`! рЃљрЃАрЃћ рЃарЃЮрЃЏ:
```
a.grad = 0
a.grad += 1.0 ├Ќ 1.0 = 1.0  # рЃърЃўрЃарЃЋрЃћрЃџрЃўрЃЊрЃљрЃю
a.grad += 1.0 ├Ќ 1.0 = 2.0  # рЃЏрЃћрЃЮрЃарЃћрЃЊрЃљрЃю
```

**рЃЏрЃљрЃЌрЃћрЃЏрЃљрЃбрЃўрЃЎрЃБрЃарЃљрЃЊ:**
```
b = a + a = 2a
db/da = 2  РюЁ
```

---

### ­Ъї│ Cell 32: рЃарЃЌрЃБрЃџрЃў рЃњрЃарЃљрЃцрЃў

```python
a = Value(-2.0, label='a')
b = Value(3.0, label='b')
d = a * b    ; d.label = 'd'
e = a + b    ; e.label = 'e'
f = d * e    ; f.label = 'f'

f.backward()
draw_dot(f)
```

**рЃарЃљрЃА рЃЋрЃ«рЃћрЃЊрЃљрЃЋрЃЌ?**

```
        a       b
       / \     / \
      /   \   /   \
     ├Ќ     \ /     +
     d      X      e
      \    / \    /
       \  /   \  /
        ├Ќ       ├Ќ
         \     /
          \   /
            f
```

рЃљрЃЦ `a` рЃЊрЃљ `b` рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ **рЃЮрЃарЃ»рЃћрЃа**!

**рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃў:**
```python
# f = d ├Ќ e = (a├Ќb) ├Ќ (a+b)
# f = a┬▓b + ab┬▓

# df/da = 2ab + b┬▓ = chain rule!
# df/db = a┬▓ + 2ab = chain rule!
```

backpropagation рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃўрЃЌрЃЋрЃџрЃўрЃА рЃљрЃЏ рЃарЃЌрЃБрЃџ рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃћрЃЉрЃА! ­ЪјЅ

---

## ­Ъј» рЃЊрЃљрЃАрЃЎрЃЋрЃюрЃљ

### рЃарЃљ рЃЋрЃўрЃАрЃгрЃљрЃЋрЃџрЃћрЃЌ?

1. РюЁ **рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃў** - рЃарЃЮрЃњрЃЮрЃа рЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ
2. РюЁ **Value рЃЎрЃџрЃљрЃАрЃў** - рЃГрЃЎрЃЋрЃўрЃљрЃюрЃў рЃарЃўрЃфрЃ«рЃЋрЃў рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃўрЃАрЃбрЃЮрЃарЃўрЃљрЃА
3. РюЁ **Backpropagation** - рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃў рЃгрЃљрЃарЃЏрЃЮрЃћрЃЉрЃБрЃџрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃљ
4. РюЁ **рЃюрЃћрЃўрЃарЃЮрЃюрЃў** - input ├Ќ weights + bias Рєњ activation
5. РюЁ **Gradient Descent** - рЃарЃЮрЃњрЃЮрЃа рЃАрЃгрЃљрЃЋрЃџрЃЮрЃЉрЃА рЃЦрЃАрЃћрЃџрЃў

---

### рЃерЃћрЃЏрЃЊрЃћрЃњрЃў рЃюрЃљрЃЉрЃўрЃ»рЃћрЃЉрЃў:

1. **рЃњрЃљрЃўрЃљрЃарЃћ notebook рЃЎрЃўрЃЊрЃћрЃЋ рЃћрЃарЃЌрЃ«рЃћрЃџ** рЃЊрЃљ рЃЊрЃљрЃгрЃћрЃарЃћ рЃЎрЃЮрЃЊрЃў рЃ«рЃћрЃџрЃўрЃЌ
2. **рЃерЃћрЃфрЃЋрЃљрЃџрЃћ рЃарЃўрЃфрЃ«рЃЋрЃћрЃЉрЃў** рЃЊрЃљ рЃюрЃљрЃ«рЃћ рЃарЃЮрЃњрЃЮрЃа рЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃў
3. **рЃЊрЃљрЃљрЃЏрЃљрЃбрЃћ рЃљрЃ«рЃљрЃџрЃў рЃЮрЃърЃћрЃарЃљрЃфрЃўрЃћрЃЉрЃў** (рЃ«рЃљрЃарЃўрЃАрЃ«рЃў, рЃњрЃљрЃДрЃЮрЃцрЃљ)
4. **рЃљрЃљрЃерЃћрЃюрЃћ рЃЏрЃарЃљрЃЋрЃљрЃџрЃў рЃюрЃћрЃўрЃарЃЮрЃюрЃў** - рЃерЃћрЃЦрЃЏрЃћрЃюрЃў рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџрЃў рЃЦрЃАрЃћрЃџрЃў!

---

## ­ЪњА рЃарЃЕрЃћрЃЋрЃћрЃЉрЃў рЃњрЃљрЃАрЃљрЃњрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА:

1. **рЃюрЃБ рЃўрЃЕрЃЦрЃљрЃарЃћрЃЉ** - рЃгрЃљрЃўрЃЎрЃўрЃЌрЃ«рЃћ рЃюрЃћрЃџрЃљ, рЃюрЃљрЃЉрЃўрЃ»-рЃюрЃљрЃЉрЃўрЃ»
2. **рЃюрЃљрЃ«рЃљрЃбрЃћ рЃЦрЃљрЃдрЃљрЃџрЃЊрЃќрЃћ** - рЃЊрЃљрЃ«рЃљрЃбрЃћ рЃњрЃарЃљрЃцрЃћрЃЉрЃў рЃ«рЃћрЃџрЃўрЃЌ
3. **рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃљрЃџрЃћ рЃ«рЃћрЃџрЃўрЃЌ** - рЃерЃћрЃљрЃЏрЃЮрЃгрЃЏрЃћ рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃў рЃЎрЃљрЃџрЃЎрЃБрЃџрЃљрЃбрЃЮрЃарЃўрЃЌ
4. **рЃЊрЃљрЃгрЃћрЃарЃћ рЃЎрЃЮрЃЊрЃў** - рЃљрЃарЃљ copy-paste, рЃљрЃарЃљрЃЏрЃћрЃЊ рЃ«рЃћрЃџрЃўрЃЌ рЃљрЃЎрЃарЃћрЃцрЃљ!
5. **рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў** - рЃерЃћрЃфрЃЋрЃљрЃџрЃћ рЃарЃўрЃфрЃ«рЃЋрЃћрЃЉрЃў, рЃЊрЃљрЃљрЃЏрЃљрЃбрЃћ рЃЮрЃърЃћрЃарЃљрЃфрЃўрЃћрЃЉрЃў

---

**рЃгрЃљрЃарЃЏрЃљрЃбрЃћрЃЉрЃћрЃЉрЃў рЃАрЃгрЃљрЃЋрЃџрЃљрЃерЃў!** ­Ъџђ­ЪДа

рЃЌрЃБ рЃарЃљрЃўрЃЏрЃћ рЃњрЃљрЃБрЃњрЃћрЃЉрЃљрЃарЃўрЃљ, рЃўрЃАрЃћрЃЋ рЃгрЃљрЃўрЃЎрЃўрЃЌрЃ«рЃћ рЃћрЃА рЃАрЃћрЃЦрЃфрЃўрЃљ. рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃўрЃљ!
